# Tensor Parallelism (TP)
defaults:
  - launcher: torchrun # distributed runner

hydra:
  job:
    env_set:
      CUDA_VISIBLE_DEVICES: 0,1

experiment_name: ${device}_${backend.name}_${benchmark.name}_${task}_tp

launcher:
  nproc_per_node: 2

backend:
  deepspeed_inference: true
  deepspeed_inference_config:
    tensor_parallel:
      tp_size: 2
