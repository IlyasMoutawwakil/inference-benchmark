defaults:
  - benchmark: training
  - backend: pytorch
  - _base_ # inherits from base config
  - _self_ # for hydra 1.1 compatibility

experiment_name: ${device}_${backend}_${benchmark}_${task}_mp

# tiny-gpt2 fails probably because it's just too small to distribute
model: gpt2
task: text-generation
device: cuda

backend:
  device_map: auto

hydra:
  job:
    env_set:
      CUDA_VISIBLE_DEVICES: 0,1
